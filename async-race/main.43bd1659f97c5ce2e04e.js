(()=>{"use strict";var e={811:(e,t,n)=>{n.r(t)},973:(e,t,n)=>{n.r(t)},375:(e,t,n)=>{n.r(t)},570:(e,t,n)=>{n.r(t)},246:(e,t,n)=>{n.r(t)},717:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(974),i=a(n(785)),s=a(n(287));t.default=class{constructor(){this.container=document.body,this.garageBtn=(0,r.addElement)("button","main-btn","TO GARAGE"),this.winnersBtn=(0,r.addElement)("button","main-btn","TO WINNERS"),this.pageContainer=(0,r.addElement)("div","page-container"),this.initApp()}initApp(){this.garageBtn.addEventListener("click",(()=>{localStorage.setItem("pageKH","garage"),new i.default(this.pageContainer)})),this.winnersBtn.addEventListener("click",(()=>{localStorage.setItem("pageKH","winners"),new s.default(this.pageContainer)}));const e=(0,r.addElement)("div","buttons-wrapper");e.append(this.garageBtn,this.winnersBtn),this.container.append(e,this.pageContainer),this.initPage()}initPage(){"winners"===localStorage.getItem("pageKH")?new s.default(this.pageContainer):new i.default(this.pageContainer)}}},881:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(33)),i=n(974);n(811),t.default=class{constructor(e,t,n,a,r){this.container=e,this.item=t,this.callbackRemove=n,this.callbackSelect=a,this.callbackWinner=r,this.car=(0,i.addElement)("div","car"),this.goBtn=(0,i.addElement)("button","main-btn","A"),this.stopBtn=(0,i.addElement)("button","primary-btn","B"),this.idAnimation=0,this.id=this.item.id,this.initCar()}initCar(){const e=(0,i.addElement)("div","car-container");e.dataset.id=String(this.item.id);const t=(0,i.addElement)("div","car-btn-wrapper"),n=(0,i.addElement)("button","primary-btn","SELECT");n.addEventListener("click",(e=>this.selectCar(e)));const a=(0,i.addElement)("button","primary-btn","REMOVE");a.addEventListener("click",(e=>this.removeCar(e)));const r=(0,i.addElement)("h2","garage-header",this.item.name);t.append(n,a,r);const s=(0,i.addElement)("div","car-track"),d=(0,i.addElement)("div","car-btn-wrapper");this.goBtn.addEventListener("click",(()=>this.startEngine())),this.stopBtn.addEventListener("click",(()=>this.stopEngine())),this.stopBtn.setAttribute("disabled","true"),this.car.innerHTML=(0,i.addCarImage)(this.item.color);const o=(0,i.addElement)("div","flag");d.append(this.goBtn,this.stopBtn,this.car),s.append(d,o),e.append(t,s),this.container.append(e)}removeCar(e){const{target:t}=e;if(t){const e=t.closest("[data-id]"),{id:n}=e.dataset;n&&this.callbackRemove(n)}}selectCar(e){const{target:t}=e;if(t){const e=t.closest("[data-id]"),{id:n}=e.dataset;n&&this.callbackSelect(n)}}startEngine(e){this.goBtn.setAttribute("disabled","true"),e||this.stopBtn.removeAttribute("disabled"),(0,i.request)(`${r.default.address}${r.default.engine}?id=${this.id}&status=started`,{method:"PATCH"}).then((t=>{this.animationCar(t.distance,t.velocity,e),(0,i.request)(`${r.default.address}${r.default.engine}?id=${this.id}&status=drive`,{method:"PATCH"}).catch((e=>{cancelAnimationFrame(this.idAnimation),console.error(e)}))})).catch((e=>console.error(e)))}stopEngine(){this.stopBtn.setAttribute("disabled","true"),this.goBtn.removeAttribute("disabled"),(0,i.request)(`${r.default.address}${r.default.engine}?id=${this.id}&status=stopped`,{method:"PATCH"}).then((()=>{cancelAnimationFrame(this.idAnimation),this.car.style.transform="translateX(0px)"})).catch((e=>console.error(e)))}animationCar(e,t,n){const a=window.innerWidth-190,r=(new Date).getTime(),i=()=>{const s=(new Date).getTime(),d=a/(e/t)*(s-r);this.car.style.transform=`translateX(${d}px)`,d<a?this.idAnimation=requestAnimationFrame(i):n&&this.callbackWinner(this.id,e/t/1e3)};i()}}},561:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(33)),i=n(974),s=a(n(881));n(973),t.default=class{constructor(e,t,n,a){this.container=e,this.callbackRemove=t,this.callbackSelect=n,this.callbackWinner=a,this.currentPage=Number(localStorage.getItem("pageGarageKH"))||1,this.cars=[],this.requestGarage()}initGarageList(e){this.currentPage>Math.ceil(Number(e.header)/7)&&(this.currentPage=Math.ceil(Number(e.header)/7),localStorage.setItem("pageGarageKH",String(this.currentPage)),this.requestGarage()),this.container.innerHTML="";const t=(0,i.addElement)("h1","garage-header",`Garage (${e.header})`),n=(0,i.addElement)("h2","garage-page",`Page #${this.currentPage}`),a=(0,i.addElement)("div","garage-list");e.data.then((e=>{this.cars=e.map((e=>new s.default(a,e,this.callbackRemove,this.callbackSelect,this.callbackWinner)))}));const r=(0,i.addElement)("div","garage-buttons-wrapper"),d=(0,i.addElement)("button","main-btn","prev");this.currentPage<2&&d.setAttribute("disabled","true"),d.addEventListener("click",(()=>this.changePage("prev")));const o=(0,i.addElement)("button","main-btn","next");this.currentPage===Math.ceil(Number(e.header)/7)&&o.setAttribute("disabled","true"),o.addEventListener("click",(()=>this.changePage("next"))),r.append(d,o),this.container.append(t,n,a,r)}changePage(e){"prev"===e?this.currentPage-=1:"next"===e&&(this.currentPage+=1),localStorage.setItem("pageGarageKH",String(this.currentPage)),this.requestGarage()}requestGarage(){(0,i.requestWithHeader)(`${r.default.address}${r.default.getCars}?_limit=7&_page=${this.currentPage}`).then((e=>this.initGarageList(e))).catch((e=>console.error(e)))}}},785:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(33)),i=n(974),s=a(n(561)),d=a(n(801));n(375);class o{constructor(e){this.container=e,this.containerList=(0,i.addElement)("div","garage"),this.updateWrapper=(0,i.addElement)("div","settings-update"),this.garageList=null,this.winner=!1,this.raceBtn=(0,i.addElement)("button","main-btn","RACE"),this.resetBtn=(0,i.addElement)("button","main-btn","RESET"),this.initGarage()}initGarage(){this.container.innerHTML="",this.initSettingsGarage(),this.initButtonsGarage(),this.garageList=new s.default(this.containerList,this.removeCar.bind(this),this.selectCar.bind(this),this.checkWinner.bind(this)),this.container.append(this.containerList)}initSettingsGarage(){const e=(0,i.addElement)("div","settings"),t=(0,i.addElement)("div","settings-create"),n=(0,i.addElement)("input","settings-create-input");n.setAttribute("type","text");const a=(0,i.addElement)("input","settings-create-color");a.setAttribute("type","color"),a.setAttribute("value","#ffffff");const r=(0,i.addElement)("button","primary-btn","CREATE");r.addEventListener("click",(e=>this.createCar(e))),this.updateWrapper=(0,i.addElement)("div","settings-update");const s=(0,i.addElement)("input","settings-update-input");s.setAttribute("type","text");const d=(0,i.addElement)("input","settings-update-color");d.setAttribute("type","color"),d.setAttribute("value","#ffffff");const o=(0,i.addElement)("button","primary-btn","UPDATE");o.addEventListener("click",(e=>this.updateCar(e))),t.append(n,a,r),this.updateWrapper.append(s,d,o),e.append(t,this.updateWrapper),this.container.append(e)}initButtonsGarage(){const e=(0,i.addElement)("div","buttons-wrapper");this.raceBtn.addEventListener("click",(()=>this.startRace())),this.resetBtn.addEventListener("click",(()=>this.resetRace())),this.resetBtn.setAttribute("disabled","true");const t=(0,i.addElement)("button","primary-btn","GENERATE CARS");t.addEventListener("click",(()=>this.generateCars())),e.append(this.raceBtn,this.resetBtn,t),this.container.append(e)}createCar(e){const{target:t}=e;if(t){const e=t.parentElement;if(e){const[t,n]=e.children,a={name:t.value,color:n.value};(0,i.request)(`${r.default.address}${r.default.getCars}`,{method:"POST",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify(a)}).then((()=>this.initGarage())).catch((e=>console.error(e)))}}}generateCars(){for(let e=0;e<100;e+=1){const e={name:`${d.default.brands[(0,i.getRandomNumber)(d.default.brands.length-1)]} ${d.default.models[(0,i.getRandomNumber)(d.default.models.length-1)]} `,color:(0,i.getRandomColor)()};(0,i.request)(`${r.default.address}${r.default.getCars}`,{method:"POST",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify(e)}).catch((e=>console.error(e)))}setTimeout((()=>this.initGarage()),400)}removeCar(e){(0,i.request)(`${r.default.address}${r.default.getCars}/${e}`,{method:"DELETE"}).then((()=>this.initGarage())).catch((e=>console.error(e))),(0,i.request)(`${r.default.address}${r.default.getWinners}/${e}`,{method:"DELETE"}).catch((e=>console.error(e)))}selectCar(e){this.updateWrapper.dataset.id=e,(0,i.request)(`${r.default.address}${r.default.getCars}/${e}`).then((e=>{const[t,n]=this.updateWrapper.children;t.value=e.name,n.value=e.color})).catch((e=>console.error(e)))}updateCar(e){const{target:t}=e;if(t){const e=t.parentElement,n=null==e?void 0:e.dataset.id;if(n&&e){const[t,a]=e.children,s={name:t.value,color:a.value};(0,i.request)(`${r.default.address}${r.default.getCars}/${n}`,{method:"PUT",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify(s)}).then((()=>this.initGarage())).catch((e=>console.error(e)))}}}startRace(){var e;this.raceBtn.setAttribute("disabled","true"),this.resetBtn.removeAttribute("disabled"),this.winner=!1,null===(e=this.garageList)||void 0===e||e.cars.forEach((e=>e.startEngine(!0)))}resetRace(){var e;this.resetBtn.setAttribute("disabled","true"),this.raceBtn.removeAttribute("disabled"),null===(e=this.garageList)||void 0===e||e.cars.forEach((e=>e.stopEngine()))}checkWinner(e,t){this.winner||(this.winner=!0,this.winnerModal(e,t.toFixed(2)),o.writeWinner(e,Number(t.toFixed(2))))}winnerModal(e,t){const n=(0,i.addElement)("div","overlay");n.addEventListener("click",(e=>{const{target:t}=e;t&&t.classList.contains("overlay")&&n.remove()})),(0,i.request)(`${r.default.address}${r.default.getCars}/${e}`).then((e=>{const a=(0,i.addElement)("div","modal");a.textContent=`${e.name} wont first (${t}s)!!!`,n.append(a),this.container.append(n)})).catch((e=>console.error(e)))}static writeWinner(e,t){(0,i.request)(`${r.default.address}${r.default.getWinners}/${e}`).then((n=>{if(0===Object.keys(n).length){const n={id:e,wins:1,time:t};(0,i.request)(`${r.default.address}${r.default.getWinners}`,{method:"POST",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify(n)}).catch((e=>console.error(e)))}else{const a={wins:n.wins+1,time:t<n.time?t:n.time};(0,i.request)(`${r.default.address}${r.default.getWinners}/${e}`,{method:"PUT",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify(a)}).catch((e=>console.error(e)))}})).catch((e=>{console.error(e)}))}}t.default=o},287:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(33)),i=n(974);n(570),t.default=class{constructor(e){this.container=e,this.currentPage=1,this.sort=localStorage.getItem("sortKH")||"id",this.order=localStorage.getItem("orderKH")||"ASC",this.requestWinners()}initWinners(e){this.container.innerHTML="";const t=(0,i.addElement)("h1","winners-header",`Winners (${e.header})`),n=(0,i.addElement)("h2","winners-page",`Page #${this.currentPage}`),a=(0,i.addElement)("table","winners-table"),r=(0,i.addElement)("tbody"),s=(0,i.addElement)("tr","winners-header-row");this.addHeaderToTable(s),r.append(s),e.data.then((e=>e.forEach(((e,t)=>r.append(this.addCarToTable(e,t)))))),a.append(r);const d=(0,i.addElement)("div","winners-buttons-wrapper"),o=(0,i.addElement)("button","main-btn","prev");this.currentPage<2&&o.setAttribute("disabled","true"),o.addEventListener("click",(()=>this.changePage("prev")));const c=(0,i.addElement)("button","main-btn","next");this.currentPage!==Math.ceil(Number(e.header)/10)&&"0"!==e.header||c.setAttribute("disabled","true"),c.addEventListener("click",(()=>this.changePage("next"))),d.append(o,c),this.container.append(t,n,a,d)}addHeaderToTable(e){const t=(0,i.addElement)("th","winners-cell","№"),n=(0,i.addElement)("th","winners-cell","Car"),a=(0,i.addElement)("th","winners-cell","Name"),r=(0,i.addElement)("th",["winners-cell","cell-clickable"]),s=(0,i.addElement)("div","cell-wrapper"),d=(0,i.addElement)("span","cell-span","Wins");s.append(d),r.append(s),r.addEventListener("click",(()=>this.addSort("wins")));const o=(0,i.addElement)("th",["winners-cell","cell-clickable"]),c=(0,i.addElement)("div","cell-wrapper"),l=(0,i.addElement)("span","cell-span","Best Time (sec)");if(c.append(l),o.append(c),o.addEventListener("click",(()=>this.addSort("time"))),"time"===this.sort){const e=document.createElement("img");e.src=`./img/arr-${"ASC"===this.order?"down":"up"}.png`,c.append(e)}else if("wins"===this.sort){const e=document.createElement("img");e.src=`./img/arr-${"ASC"===this.order?"down":"up"}.png`,s.append(e)}e.append(t,n,a,r,o)}addCarToTable(e,t){const n=(0,i.addElement)("tr","winners-row"),a=(0,i.addElement)("td","winners-cell",String(10*this.currentPage+t-9));return n.append(a),(0,i.request)(`${r.default.address}${r.default.getCars}/${e.id}`).then((t=>{const a=(0,i.addElement)("td","winners-cell");a.innerHTML=(0,i.addCarImage)(t.color);const r=(0,i.addElement)("td","winners-cell",t.name),s=(0,i.addElement)("td","winners-cell",String(e.wins)),d=(0,i.addElement)("td","winners-cell",String(e.time));n.append(a,r,s,d)})).catch((e=>console.error(e))),n}changePage(e){"prev"===e?this.currentPage-=1:"next"===e&&(this.currentPage+=1),this.requestWinners()}requestWinners(){(0,i.requestWithHeader)(`${r.default.address}${r.default.getWinners}?_limit=10&_page=${this.currentPage}&_sort=${this.sort}&_order=${this.order}`).then((e=>this.initWinners(e)))}addSort(e){this.sort=e,this.order="ASC"===this.order?"DESC":"ASC",localStorage.setItem("sortKH",this.sort),localStorage.setItem("orderKH",this.order),this.requestWinners()}}},607:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(717));n(246),new r.default},33:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.address="http://127.0.0.1:3000",e.getCars="/garage",e.getWinners="/winners",e.engine="/engine"}(n||(n={})),t.default=n},974:function(e,t){var n=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,i){function s(e){try{o(a.next(e))}catch(e){i(e)}}function d(e){try{o(a.throw(e))}catch(e){i(e)}}function o(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,d)}o((a=a.apply(e,t||[])).next())}))};function a(e){return Math.round(Math.random()*e)}Object.defineProperty(t,"__esModule",{value:!0}),t.addCarImage=t.getRandomColor=t.getRandomNumber=t.requestWithHeader=t.request=t.addElement=void 0,t.addElement=function(e,t,n){const a=document.createElement(e);return t&&(Array.isArray(t)?t.forEach((e=>{a.classList.add(e)})):a.classList.add(t)),n&&(a.textContent=n),a},t.request=function(e,t={}){return n(this,void 0,void 0,(function*(){return(yield fetch(e,t)).json()}))},t.requestWithHeader=function(e,t={}){return n(this,void 0,void 0,(function*(){const n=yield fetch(e,t),a=n.headers.get("X-Total-Count");return{data:n.json(),header:a}}))},t.getRandomNumber=a,t.getRandomColor=function(){let e="#";for(;e.length<7;)e+="0123456789ABCDEF"[a(15)];return e},t.addCarImage=function(e){return`\n  <svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="1280.000000pt" height="600.000000pt" viewBox="0 0 1280.000000 600.000000"\n  preserveAspectRatio="xMidYMid meet">\n  <g transform="translate(0.000000,720.000000) scale(0.100000,-0.100000)"\n  fill="${e}" stroke="none">\n  <path d="M5775 5093 c-16 -8 -37 -22 -46 -29 -12 -11 -21 -11 -47 -2 -27 11 -35 10 -59 -8 -36 -25 -100 -152 -115 -226 -11 -54 -11 -59 11 -81 12 -14 37 -33 56 -43 25 -13 33 -24 33 -44 -2 -59 19 -78 218 -195 l156 -92 -36 -22 c-131 -81 -100 -239 62 -313 34 -16 89 -31 122 -35 33 -3 60 -9 60 -14 0 -16 -128 -18 -1166 -23 l-1060 -6 -32 45 c-37 53 -39 61 -12 70 71 23 102 245 55 403 -17 58 -105 196 -134 211 -11 6 -49 11 -84 11 -49 0 -70 -5 -90 -20 -41 -32 -94 -149 -102 -223 -7 -61 4 -161 20 -201 8 -17 5 -18 -41 -12 -88 13 -85\n  5 -54 109 53 179 110 491 93 508 -6 6 -38 13 -72 16 l-61 6 0 38 c0 37 -1 38 -46 45 -73 11 -122 0 -160 -37 -42 -40 -65 -96 -109 -256 -52 -190 -90 -322 -95 -327 -3 -2 -84 -12 -180 -20 -96 -9 -218 -23 -270 -32 -98 -15 -480 -97 -539 -116 -24 -7 -39 -7 -55 1 -18 10 -63 5 -241 -28 -644 -118 -1096 -181 -1305 -181 -76 0 -141 -4 -144 -8 -2 -4 2 -46 11 -92 12 -72 13 -114 3 -270\n  -6 -102 -15 -223 -21 -269 l-10 -85 -105 -160 -105 -160 6 -80 c25 -312 51 -456 111 -611 61 -156 61 -161 25 -215 -17 -24 -27 -48 -22 -53 23 -23 257 -57 556 -82 278 -23 373 -19 383 17 4 15 14 18 71 17 115 -2 118 -4 155 -94 218 -529 819 -780 1350 -564 217 88 420 275 525 482 l34 67 52 0 c96 0 145 -11 145 -31 0 -18 41 -19 1433 -19 787 0 2042 3 2788 7 1309 6 1356 7 1351 25\n  -4 17 4 18 124 18 l129 -1 45 -71 c84 -133 226 -266 370 -346 273 -153 631 -167 925 -37 78 35 206 120 277 184 65 59 167 190 204 262 l24 49 140 0 c136 0 140 -1 140 -21 l0 -21 518 4 c391 3 522 7 540 16 17 10 22 22 22 52 0 21 -4 41 -10 45 -5 3 -39 8 -75 12 -73 7 -74 8 -53 87 11 41 15 45 49 51 20 4 45 13 56 20 16 12 13 14 -34 21 l-52 7 5 61 c8 87 7 86 61 86 69 0 176 19 191 34 25\n  24 35 183 28 441 -7 265 -15 356 -41 445 -32 107 -206 245 -438 347 -682 301 -2088 506 -3914 573 -266 10 -273 10 -309 35 -50 34 -123 55 -214 62 -69 5 -84 10 -185 68 -469 266 -1334 683 -1575 760 -30 9 -60 23 -66 31 -14 17 -77 44 -101 44 -10 -1 -31 -8 -48 -17z m-3825 -3229 c13 -13 13 -16 0 -24 -21 -14 -81 -30 -111 -30 -42 0 -115 29 -140 57 l-24 25 130 -7 c91 -5 134 -11 145\n  -21z m858 -35 c56 0 63 -2 42 -10 -30 -13 -119 -4 -134 12 -8 9 -6 10 7 5 10 -3 49 -6 85 -7z m7250 -19 c77 -24 202 -26 282 -5 66 17 72 11 67 -61 -5 -71 -45 -136 -105 -171 -39 -23 -59 -28 -112 -28 -89 1 -157 41 -196 118 -21 40 -29 119 -15 145 7 12 13 22 14 22 1 0 31 -9 65 -20z m-7890 -80 c77 -24 216 -27 287 -5 27 8 52 12 57 9 4 -3 8 -24 8 -46 0 -131 -94 -228 -223 -228 -122 0 -229 125 -211 248 3 23 9 42 13 42 3 0 35 -9 69 -20z"/>\n  </g>\n  </svg>\n  `}},801:e=>{e.exports=JSON.parse('{"brands":["Toyota","Ford","Mercedes-Benz","Suzuki","Mitsubishi","Lexus","Honda","Nissan","Mazda","Infiniti","Subaru","Porsche","Volkswagen","Maybach","BMW","Audi","Hyundai","Kia","Opel","Skoda","Acura","Bentley","Cadillac","Chevrolet","Dodge","Ferrari","Genesis","Jaguar","Jeep","Lamborghini","Land Rover","Lotus","Maserati","McLaren","MINI","Opel","Rolls-Royce","Smart","Tesla","Volvo"],"models":["Camry","Corolla","Rav4","Auris","Mark","GTR","Teana","Explorer","EcoSport","Mondeo","Focus","Fusion","S","E","C","SX4","Grand Vitara","Vitara","Jimny","ASX","Outlander","RX350","CR-V","Accord","Civic","6","3","Forester","Cayene","Panamera","Golf","Polo","Tiguan","Touareg","M","A3","A5","K5","Rio","Cerato","Stinger","Sonata","Solaris","Mokka","Astra","Octavia","Ceed","Sorento","Sportage","Fabia","Rapid","MDX","RDX","Aveo","Captiva","Cruze","Lacetti","Cherokee","Patriot","Aventador","Diablo","Huracan","Murcielago","Urus","Discovery","Freelander","Sport","GranTurismo","Cullinan","Dawn","Ghost","Phantom","Wraith","Roadster","Fortwo","Model S","Model 3","Model X","Model Y","XC60","XC90","S90","S80"]}')}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,n),i.exports}n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(607)})();